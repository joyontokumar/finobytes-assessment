{"ast":null,"code":"var _jsxFileName = \"/Users/joyontokumarroy/Desktop/finobytes/src/HOC/withAuth.tsx\";\nimport React, { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport storage from \"redux-persist/lib/storage\";\nimport { resetTokenInfo } from \"../store/slices/token\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst withAuth = Component => {\n  var _s = $RefreshSig$();\n  return _s(function AuthWrapper() {\n    _s();\n    const dispatch = useDispatch();\n    const navigate = useNavigate();\n    const {\n      pathname\n    } = useLocation();\n    const tokenInfo = useSelector(state => state.tokenInfo);\n    const publicRoutes = [\"/login/admin\", \"/login/merchant\", \"/login/member\"];\n    const isTokenValid = Boolean(tokenInfo === null || tokenInfo === void 0 ? void 0 : tokenInfo.token);\n    const isPublicRoute = publicRoutes.includes(pathname);\n    useEffect(() => {\n      if (!isTokenValid && !isPublicRoute) {\n        dispatch(resetTokenInfo());\n        storage.removeItem(\"persist:root\");\n        navigate(\"/login/admin\", {\n          replace: true\n        });\n      }\n      if (isTokenValid && isPublicRoute) {\n        navigate(\"/\", {\n          replace: true\n        });\n      }\n    }, [isTokenValid, isPublicRoute, dispatch, navigate, pathname]);\n    if (isTokenValid && !isPublicRoute || !isTokenValid && isPublicRoute) {\n      return /*#__PURE__*/_jsxDEV(Component, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 34,\n        columnNumber: 14\n      }, this);\n    }\n    return null;\n  }, \"vA9gGVrStIFO7F3EeydeMRhFWH4=\", false, function () {\n    return [useDispatch, useNavigate, useLocation, useSelector];\n  });\n};\nexport default withAuth;","map":{"version":3,"names":["React","useEffect","useDispatch","useSelector","useLocation","useNavigate","storage","resetTokenInfo","jsxDEV","_jsxDEV","withAuth","Component","_s","$RefreshSig$","AuthWrapper","dispatch","navigate","pathname","tokenInfo","state","publicRoutes","isTokenValid","Boolean","token","isPublicRoute","includes","removeItem","replace","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["/Users/joyontokumarroy/Desktop/finobytes/src/HOC/withAuth.tsx"],"sourcesContent":["import React, { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport storage from \"redux-persist/lib/storage\";\n\nimport { RootState } from \"../store\";\nimport { resetTokenInfo } from \"../store/slices/token\";\n\nconst withAuth = (Component: React.ComponentType) => {\n  return function AuthWrapper() {\n    const dispatch = useDispatch();\n    const navigate = useNavigate();\n    const { pathname } = useLocation();\n\n    const tokenInfo: any = useSelector((state: RootState) => state.tokenInfo);\n\n    const publicRoutes = [\"/login/admin\", \"/login/merchant\", \"/login/member\"];\n    const isTokenValid = Boolean(tokenInfo?.token);\n    const isPublicRoute = publicRoutes.includes(pathname);\n\n    useEffect(() => {\n      if (!isTokenValid && !isPublicRoute) {\n        dispatch(resetTokenInfo());\n        storage.removeItem(\"persist:root\");\n        navigate(\"/login/admin\", { replace: true });\n      }\n\n      if (isTokenValid && isPublicRoute) {\n        navigate(\"/\", { replace: true });\n      }\n    }, [isTokenValid, isPublicRoute, dispatch, navigate, pathname]);\n\n    if ((isTokenValid && !isPublicRoute) || (!isTokenValid && isPublicRoute)) {\n      return <Component />;\n    }\n\n    return null;\n  };\n};\n\nexport default withAuth;\n"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,SAAS,QAAQ,OAAO;AACxC,SAASC,WAAW,EAAEC,WAAW,QAAQ,aAAa;AACtD,SAASC,WAAW,EAAEC,WAAW,QAAQ,kBAAkB;AAC3D,OAAOC,OAAO,MAAM,2BAA2B;AAG/C,SAASC,cAAc,QAAQ,uBAAuB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEvD,MAAMC,QAAQ,GAAIC,SAA8B,IAAK;EAAA,IAAAC,EAAA,GAAAC,YAAA;EACnD,OAAAD,EAAA,CAAO,SAASE,WAAWA,CAAA,EAAG;IAAAF,EAAA;IAC5B,MAAMG,QAAQ,GAAGb,WAAW,CAAC,CAAC;IAC9B,MAAMc,QAAQ,GAAGX,WAAW,CAAC,CAAC;IAC9B,MAAM;MAAEY;IAAS,CAAC,GAAGb,WAAW,CAAC,CAAC;IAElC,MAAMc,SAAc,GAAGf,WAAW,CAAEgB,KAAgB,IAAKA,KAAK,CAACD,SAAS,CAAC;IAEzE,MAAME,YAAY,GAAG,CAAC,cAAc,EAAE,iBAAiB,EAAE,eAAe,CAAC;IACzE,MAAMC,YAAY,GAAGC,OAAO,CAACJ,SAAS,aAATA,SAAS,uBAATA,SAAS,CAAEK,KAAK,CAAC;IAC9C,MAAMC,aAAa,GAAGJ,YAAY,CAACK,QAAQ,CAACR,QAAQ,CAAC;IAErDhB,SAAS,CAAC,MAAM;MACd,IAAI,CAACoB,YAAY,IAAI,CAACG,aAAa,EAAE;QACnCT,QAAQ,CAACR,cAAc,CAAC,CAAC,CAAC;QAC1BD,OAAO,CAACoB,UAAU,CAAC,cAAc,CAAC;QAClCV,QAAQ,CAAC,cAAc,EAAE;UAAEW,OAAO,EAAE;QAAK,CAAC,CAAC;MAC7C;MAEA,IAAIN,YAAY,IAAIG,aAAa,EAAE;QACjCR,QAAQ,CAAC,GAAG,EAAE;UAAEW,OAAO,EAAE;QAAK,CAAC,CAAC;MAClC;IACF,CAAC,EAAE,CAACN,YAAY,EAAEG,aAAa,EAAET,QAAQ,EAAEC,QAAQ,EAAEC,QAAQ,CAAC,CAAC;IAE/D,IAAKI,YAAY,IAAI,CAACG,aAAa,IAAM,CAACH,YAAY,IAAIG,aAAc,EAAE;MACxE,oBAAOf,OAAA,CAACE,SAAS;QAAAiB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC;IACtB;IAEA,OAAO,IAAI;EACb,CAAC;IAAA,QA3BkB7B,WAAW,EACXG,WAAW,EACPD,WAAW,EAETD,WAAW;EAAA;AAwBtC,CAAC;AAED,eAAeO,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}